<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="才权的博客">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="才权的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="才权的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/4/"/>





  <title> 才权的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4e94c4c1ded5d320541370545af638ea";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">才权的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/11/TensorFlow开发环境搭建（Ubuntu16-04-GPU-TensorFlow源码编译）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/11/TensorFlow开发环境搭建（Ubuntu16-04-GPU-TensorFlow源码编译）/" itemprop="url">
                  TensorFlow开发环境搭建（Ubuntu16.04+GPU+TensorFlow源码编译）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-11T20:47:36+08:00">
                2018-01-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://zhuanlan.zhihu.com/p/33089119" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/33089119</a></p>
<h1 id="1-安装选择"><a href="#1-安装选择" class="headerlink" title="1 安装选择"></a>1 安装选择</h1><h2 id="1-1-平台"><a href="#1-1-平台" class="headerlink" title="1.1 平台"></a>1.1 平台</h2><p>目前TensorFlow已支持Mac、Ubuntu和Windows三个主流平台（64位平台），<br><img src="http://upload-images.jianshu.io/upload_images/4905018-d562d05d81808e9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://www.tensorflow.org/install/"></p>
<h2 id="1-2-GPU-vs-CPU"><a href="#1-2-GPU-vs-CPU" class="headerlink" title="1.2 GPU vs CPU"></a>1.2 GPU vs CPU</h2><p>在安装时可以选择安装版本是否支持GPU，<br><img src="http://upload-images.jianshu.io/upload_images/4905018-63dce636960a5e42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://www.tensorflow.org/install/install_linux"></p>
<h2 id="1-3-二进制安装-vs-源码安装"><a href="#1-3-二进制安装-vs-源码安装" class="headerlink" title="1.3 二进制安装 vs 源码安装"></a>1.3 二进制安装 vs 源码安装</h2><p>同时，安装时可以考虑采用二进制安装，还是源码安装，<br><img src="http://upload-images.jianshu.io/upload_images/4905018-caff1336d1dd1238.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://www.tensorflow.org/install/"></p>
<h2 id="1-4-二进制安装选择"><a href="#1-4-二进制安装选择" class="headerlink" title="1.4 二进制安装选择"></a>1.4 二进制安装选择</h2><p>二进制安装可以有多种选择，<br><img src="http://upload-images.jianshu.io/upload_images/4905018-6d617b3d2e736011.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://www.tensorflow.org/install/install_linux"></p>
<h2 id="1-5-实际使用选择"><a href="#1-5-实际使用选择" class="headerlink" title="1.5 实际使用选择"></a>1.5 实际使用选择</h2><p>手头上有两台电脑，</p>
<ul>
<li>MacBook Pro (Retina, 13-inch, Early 2015)<br>处理器：2.7 GHz Intel Core i5<br>内存：8GB 1867MHz DDR3<br>显卡：Intel Iris Graphics 6100 1536MB</li>
<li>攀升兄弟组装台式机<br>处理器：英特尔 Core i7-6700 @3.40GHz 四核<br>主板：华硕 B150M-ET M2 SERIES<br>内存：8G（威刚DDR4 2801MHz）<br>硬盘：三星 MZ7TE256HMHP-00000（256GB/固态硬盘）<br>显卡：Nvidia GeForce GTX 950(2GB)</li>
</ul>
<p>其中，<br>MacBook Pro采用基于Anaconda的二进制安装方式（仅支持CPU）。Anaconda是一个集成平台，包含大多数机器学习的常用工具，</p>
<ul>
<li>NumPy：科学运算包</li>
<li>SciPy：在NumPy的基础上构建，功能更加强大的科学计算包</li>
<li>Matplotlib：类似Matlab的绘图工具包</li>
<li>Scikit-learn：经典机器学习工具包</li>
<li>Pandas：数据处理和分析工具包（可用于数据读写、清洗、填充和分析等场景）<br>采用Anaconda安装方案，一方面MacBook Pro的开发环境很容易搭建（几句命令即可完成），另一方面，基于Anaconda的环境，也可以方便验证简单的机器学习算法。</li>
</ul>
<p>对于台式机则采用了Ubuntu+GPU+TensorFlow源码编译的方式，进行TensorFlow环境搭建，下面我们着重介绍下这种安装方式。</p>
<h1 id="2-Ubuntu16-04-TensorFlow-GPU-源码编译"><a href="#2-Ubuntu16-04-TensorFlow-GPU-源码编译" class="headerlink" title="2 Ubuntu16.04+TensorFlow(GPU)源码编译"></a>2 Ubuntu16.04+TensorFlow(GPU)源码编译</h1><h2 id="2-1-Ubuntu系统安装"><a href="#2-1-Ubuntu系统安装" class="headerlink" title="2.1 Ubuntu系统安装"></a>2.1 Ubuntu系统安装</h2><p>目前，大多数计算机，包括台式机已没有了光驱，同时，Ubuntu的系统安装盘也不易获得。针对这种情况，我们可以采用U盘来进行安装。具体步骤可以参考：<a href="http://www.linuxidc.com/Linux/2016-04/130520.htm" target="_blank" rel="external">《Ubuntu 16.04 U盘安装图文教程》</a></p>
<h2 id="2-2-禁用UEFI安全启动"><a href="#2-2-禁用UEFI安全启动" class="headerlink" title="2.2 禁用UEFI安全启动"></a>2.2 禁用UEFI安全启动</h2><p>对于华硕 B150M-ET主板，UEFI默认是开启的。而UEFI开启会导致第三方驱动安装失败（如显卡驱动，这是源码编译安装GPU支持的TensorFlow，遇到的第一个坑）。具体步骤可以参考：<a href="https://www.cnblogs.com/zhaofenqiang/p/6071385.html?utm_source=itdadao&amp;utm_medium=referral" target="_blank" rel="external">《华硕主板禁用UEFI安全启动》</a></p>
<h2 id="2-3-安装NVIDIA驱动"><a href="#2-3-安装NVIDIA驱动" class="headerlink" title="2.3 安装NVIDIA驱动"></a>2.3 安装NVIDIA驱动</h2><h3 id="2-3-1-安装方式"><a href="#2-3-1-安装方式" class="headerlink" title="2.3.1 安装方式"></a>2.3.1 安装方式</h3><p>英伟达的显卡驱动有三种方式：</p>
<ul>
<li>apt-get+系统设置安装</li>
<li>安装CUDA时顺便安装</li>
<li><p>官方下载最新驱动并安装<br>参考：<a href="http://blog.csdn.net/cosmoshua/article/details/76644029" target="_blank" rel="external">《Ubuntu 16.04安装NVIDIA驱动》</a></p>
<h3 id="2-3-2-安装步骤"><a href="#2-3-2-安装步骤" class="headerlink" title="2.3.2 安装步骤"></a>2.3.2 安装步骤</h3><p>本文采用第一种方案：</p>
<pre><code>sudo apt-get install nvidia-367
</code></pre></li>
</ul>
<p>然后进入：System Settings-&gt;Software&amp;Updates-&gt;Additional Drivers-&gt;，选择NVIDIA Corporation[Using NVIDIA binary driver]</p>
<h3 id="2-3-3-验证测试"><a href="#2-3-3-验证测试" class="headerlink" title="2.3.3 验证测试"></a>2.3.3 验证测试</h3><pre><code>nvidia-smi #若列出GPU的信息列表，表示驱动安装成功
nvidia-settings #若弹出设置对话框，亦表示驱动安装成功
</code></pre><h2 id="2-4-安装CUDA"><a href="#2-4-安装CUDA" class="headerlink" title="2.4 安装CUDA"></a>2.4 安装CUDA</h2><p>CUDA(Compute Unified Device Architecture)，是显卡厂商NVIDIA推出的运算平台。可以理解成基于GPU并行计算的应用层接口。<br><a href="https://developer.nvidia.com/cuda-80-download-archive" target="_blank" rel="external">CUDA8.0下载地址</a><br><img src="http://upload-images.jianshu.io/upload_images/4905018-d71f88879413fe85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://developer.nvidia.com/cuda-80-download-archive"><br>安装Cuda的时候，需要关闭X服务。</p>
<pre><code>sudo service lightdm stop
</code></pre><p>这时，系统会出现黑屏。此时，同时按住[CTRL + ALT + F1]三个键进入命令行模式（如果不能进入命令行模式，可以参考<a href="http://blog.csdn.net/u010733679/article/details/52022094" target="_blank" rel="external">《alt+ctrl+F1黑屏 ，解决方案》</a>），<br>然后输入[账号]，[密码]后登陆。<br>在CUDA的下载目录运行，</p>
<pre><code>sudo sh cuda_xxx.run
</code></pre><p>需要注意的是，在询问是否安装“NVIDIA Accelerated Graphics Driver”可以选择“是”，</p>
<pre><code>Install NVIDIA Accelerated Graphics Driver for Linux-x86_64 361.62?
(y)es/(n)o/(q)uit: y
</code></pre><p>但在后续出现询问是否安装“X configuration”时，则需要选择“否”，否则之前安装的显卡驱动就白安装了。<br>CUDA安装结束后，则可以恢复到图形界面模式，</p>
<pre><code>sudo service lightdm start
</code></pre><p>到这里，CUDA的安装还不算结束，需要将CUDA相关的内容添加到系统环境变量中。安装过程中Summary提示，</p>
<pre><code>Please make sure that
– PATH includes /usr/local/cuda-8.0/bin
– LD_LIBRARY_PATH includes /usr/local/cuda-8.0/lib64, or, add /usr/local/cuda-8.0/lib64 to /etc/ld.so.conf and run ldconfig as root
</code></pre><p>CUDA相关的环境变量可以放在~/.bashrc中，</p>
<pre><code>vi ~/.bash_profile
</code></pre><p>在其中，增加如下两行，</p>
<pre><code>export LD_LIBRARY_PATH=&quot;$LD_LIBRARY_PATH:/usr/local/cuda-  8.0/lib64:/usr/local/cuda-8.0/extras/CUPTI/lib64&quot;
export CUDA_HOME=/usr/local/cuda-8.0
</code></pre><h2 id="2-5-安装cuDNN"><a href="#2-5-安装cuDNN" class="headerlink" title="2.5 安装cuDNN"></a>2.5 安装cuDNN</h2><p>cuDNN（CUDA Deep Neural Network）相比标准的cuda，它在一些常用的神经网络操作上进行了性能的优化，比如卷积，pooling，归一化，以及激活层等等。<br>下载地址：<a href="https://developer.nvidia.com/rdp/cudnn-download" target="_blank" rel="external">https://developer.nvidia.com/rdp/cudnn-download</a><br><img src="http://upload-images.jianshu.io/upload_images/4905018-1c28d7c5a2928ca9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://developer.nvidia.com/rdp/cudnn-download"></p>
<p>下载cuDNN后进行解压，并执行如下命令：</p>
<pre><code>sudo cp cuda/include/cudnn.h /usr/local/cuda-8.0/include
sudo cp -d cuda/lib64/libcudnn* /usr/local/cuda-8.0/lib64
sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda-8.0/lib64/libcudnn*
</code></pre><h2 id="2-6-gcc降低版本"><a href="#2-6-gcc降低版本" class="headerlink" title="2.6 gcc降低版本"></a>2.6 gcc降低版本</h2><p>网上说cuda8.0不支持5.0以上的编译器，因此需要降级，把编译器版本降到4.9，但我看了CUDA8.0的安装手册《NVIDIA CUDA INSTALLATION GUIDE FOR<br>LINUX》，并没有发现这一条，<br><img src="http://upload-images.jianshu.io/upload_images/4905018-aee83a196d31033d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="《NVIDIA CUDA INSTALLATION GUIDE FOR
LINUX》"><br>在实际使用中，还是将GCC做了降级（PS，在安装时可以先不降级，看看是否会出问题），GCC降级方法如下，</p>
<pre><code>sudo apt-get install g++-4.9
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.9 20
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-5 10
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.9 20
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-5 10
sudo update-alternatives --install /usr/bin/cc cc /usr/bin/gcc 30
sudo update-alternatives --set cc /usr/bin/gcc
sudo update-alternatives --install /usr/bin/c++ c++ /usr/bin/g++ 30
sudo update-alternatives --set c++ /usr/bin/g++
</code></pre><h2 id="2-7-安装Bazel"><a href="#2-7-安装Bazel" class="headerlink" title="2.7 安装Bazel"></a>2.7 安装Bazel</h2><p>Bazel是一个构建工具，即一个可以运行编译和测试来组装软件的工具，跟Make、Ant、Gradle、Buck、Pants和Maven一样。TensorFlow的编译是基于Bazel完成的。<br>Bazel官方地址：<a href="https://docs.bazel.build/versions/master/install.html" target="_blank" rel="external">https://docs.bazel.build/versions/master/install.html</a><br><img src="http://upload-images.jianshu.io/upload_images/4905018-f5576ff594245afb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://docs.bazel.build/versions/master/install.html"></p>
<h3 id="2-7-1-安装准备"><a href="#2-7-1-安装准备" class="headerlink" title="2.7.1 安装准备"></a>2.7.1 安装准备</h3><p><img src="http://upload-images.jianshu.io/upload_images/4905018-01725f875ea14762.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="https://docs.bazel.build/versions/master/install-ubuntu.html"></p>
<h3 id="2-7-2-安装"><a href="#2-7-2-安装" class="headerlink" title="2.7.2 安装"></a>2.7.2 安装</h3><p>Bazel可以通过apt-get和下载安装两种方式完成，本文中，采用下载安装的方式实现，</p>
<pre><code>chmod +x PATH_TO_INSTALL.SH 
./PATH_TO_INSTALL.SH --user 
</code></pre><h2 id="2-8-第三方库安装"><a href="#2-8-第三方库安装" class="headerlink" title="2.8 第三方库安装"></a>2.8 第三方库安装</h2><pre><code>sudo apt-get install python-numpy swig python-dev python-wheel
sudo apt-get install libcupti-dev
sudo apt-get install git
</code></pre><h2 id="2-9-TensorFlow源码编译"><a href="#2-9-TensorFlow源码编译" class="headerlink" title="2.9 TensorFlow源码编译"></a>2.9 TensorFlow源码编译</h2><h3 id="2-9-1-下载"><a href="#2-9-1-下载" class="headerlink" title="2.9.1 下载"></a>2.9.1 下载</h3><pre><code>git clone https://github.com/tensorflow/tensorflow
</code></pre><h3 id="2-9-2-编译配置"><a href="#2-9-2-编译配置" class="headerlink" title="2.9.2 编译配置"></a>2.9.2 编译配置</h3><pre><code>cd ~/tensorflow
./configure
</code></pre><h3 id="2-9-3-编译安装"><a href="#2-9-3-编译安装" class="headerlink" title="2.9.3 编译安装"></a>2.9.3 编译安装</h3><pre><code>bazel build -c opt //tensorflow/tools/pip_package:build_pip_package
bazel build -c opt --config=cuda //tensorflow/tools/pip_package:build_pip_package
bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg
sudo pip install /tmp/tensorflow_pkg/tensorflow-0.10.0-cp2-none-any.whl
</code></pre><p>至此，便完成了支持GPU的TensorFlow源码编译。</p>
<h2 id="2-10-环境测试"><a href="#2-10-环境测试" class="headerlink" title="2.10 环境测试"></a>2.10 环境测试</h2><p>可以通过如下代码进行测试，</p>
<pre><code># Python
import tensorflow as tf
hello = tf.constant(&apos;Hello, TensorFlow!&apos;)
sess = tf.Session()
print(sess.run(hello))
</code></pre><p>正常测试输出，</p>
<pre><code>Hello, TensorFlow!
</code></pre><h1 id="3-资料参考"><a href="#3-资料参考" class="headerlink" title="3 资料参考"></a>3 资料参考</h1><p><a href="http://www.linuxidc.com/Linux/2016-04/130520.htm" target="_blank" rel="external">《Ubuntu 16.04 U盘安装图文教程》</a><br><a href="https://www.cnblogs.com/zhaofenqiang/p/6071385.html?utm_source=itdadao&amp;utm_medium=referral" target="_blank" rel="external">《华硕主板禁用UEFI安全启动》</a><br><a href="http://blog.csdn.net/cosmoshua/article/details/76644029" target="_blank" rel="external">《Ubuntu 16.04安装NVIDIA驱动》</a><br><a href="http://blog.csdn.net/u010733679/article/details/52022094" target="_blank" rel="external">《alt+ctrl+F1黑屏 ，解决方案》</a><br><a href="https://segmentfault.com/a/1190000008234390" target="_blank" rel="external">《Ubuntu16.04 下安装GPU版TensorFlow（包括Cuda和Cudnn）》</a><br><a href="http://blog.csdn.net/zhaoyu106/article/details/52793183" target="_blank" rel="external">《ubuntu16.04下安装TensorFlow(GPU加速)》</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/12/机器学习-深度学习入门资料汇总/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/12/机器学习-深度学习入门资料汇总/" itemprop="url">
                  机器学习/深度学习入门资料汇总
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-12T04:18:36+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://zhuanlan.zhihu.com/p/30980999" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/30980999</a></p>
<p>经常被同学和朋友询问机器学习或深度学习入门，有哪些不错的参考资料。老实讲，这个问题在网上随便一搜就是一大把的答案。我自己在最开始的时候也有同样的困惑，同样在搜索引擎和论坛里翻找答案。但大多数答案并不怎么让人满意：搜索结果要么星稀零散，只见树木不见森林；要么过于详尽，让人无从下手（很多资料作者自己都没看过）。<br>在这篇文章里，我把自己在学习过程中的参考资料进行了梳理。一方面，希望能给你一个相对系统的学习路线参考；另一方面，自己真实的实践经历，遇过坎，掉过坑，希望能给正准备入门的同学更多真实的借鉴。</p>
<h2 id="入门视频"><a href="#入门视频" class="headerlink" title="入门视频"></a>入门视频</h2><h3 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h3><p>很多人会推荐吴恩达在斯坦福的公开课CS229，但对于初学的同学来说，我觉得并不适合。虽然Andrew在课的最开始就说了，他的这门看更侧重于实践。但真实情况是，里面有太多的数学推导和证明。直接使用这门课来入门，对初学的同学来说，在信心上会是不小的打击。特别是很多从应用开发转到机器学习的同学，毕竟在平常的工作中，大学的数学知识在实际的开发中应用的并不多，估计很多现在都已经生疏了。<br>对于机器学习，我推荐吴恩达在Coursera开设的机器学习课程，课程免费，侧重于基本的原理和工程实现，对初学者相对友好。字幕中英可选。<br>课程链接：<a href="https://www.coursera.org/learn/machine-learning" target="_blank" rel="external">https://www.coursera.org/learn/machine-learning</a></p>
<h3 id="深度学习"><a href="#深度学习" class="headerlink" title="深度学习"></a>深度学习</h3><p>大家可能看过《一天搞懂深度学习》的PPT，作者是台湾大学的李宏毅老师。其实，李宏毅老师还有门深度学习的课程，视频也挂在网上。这门课主要针对初学者，而且，不需要有经典的机器学习基础（其实，深度学习入门，比经典的机器学习更容易）。课程的内容深入浅出，训练和预测样本都是各种数码宝贝和二次元卡通人物，绝对让你耳目一新。好像没有字幕，中文授课（台湾腔）。<br>课程链接：<a href="http://speech.ee.ntu.edu.tw/~tlkagk/courses_ML17.html" target="_blank" rel="external">http://speech.ee.ntu.edu.tw/~tlkagk/courses_ML17.html</a></p>
<p>在看李宏毅老师的视频时，Andrew的《深度学习工程师》项目还没开始。后来把Andrew的课程看完（一共五部分，目前只出了前四部分），觉得Andrew的课程同样很棒。两者对比，李宏毅老师的课，课时相对较短，内容相对全面（对无监督学习、对抗学习、强化学习都有介绍），课程偏重概念介绍，但涉及到数学的部分跳跃性较大，不容易跟上。Andrew的课学时相对较长（一共五个大的部分），内容相对集中（主要讲解监督学习，集中在DNN、CNN和RNN），但讲解和分析更加细致，学习曲线相对平坦。针对于初学者可以先看李宏毅老师的课程对深度学习有个整体的框架认识，然后看Andrew的课程把握更多的细节知识。Andrew的课程本来是Coursera的付费课程，目前跟网易云课堂合作，不用翻墙就可以看了。<br>课程链接：<a href="https://mooc.study.163.com/smartSpec/detail/1001319001.htm" target="_blank" rel="external">https://mooc.study.163.com/smartSpec/detail/1001319001.htm</a></p>
<h2 id="入门书籍"><a href="#入门书籍" class="headerlink" title="入门书籍"></a>入门书籍</h2><h3 id="机器学习-1"><a href="#机器学习-1" class="headerlink" title="机器学习"></a>机器学习</h3><p><img src="http://upload-images.jianshu.io/upload_images/4905018-87dd57bb4f2c2fd9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="《机器学习》"></p>
<p>机器学习的入门书籍，当仁不让的就是周志华老师的西瓜书《机器学习》了。这本书基本囊括了绝大多数经典的机器学习方法。但坦白的讲，这本书入门也不是那么轻松，大量篇幅的数学推导和证明。建议初学者可以在第一遍的时候跳过具体的数学推导，更侧重在知识框架和原理的学习和提炼，后面可以通过第二遍或第三遍来深入其中的数学原理。</p>
<h3 id="深度学习-1"><a href="#深度学习-1" class="headerlink" title="深度学习"></a>深度学习</h3><p><img src="http://upload-images.jianshu.io/upload_images/4905018-9f5ed279f267584c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="《深度学习》"><br>这一本称为目前深度学习领域的圣经，而作者们也确实做到了深入浅出，循序渐进。不是单纯的抛一个结论，而是逐步的深入，最终阐明原理。建议像《机器学习》一样使用：不要求第一遍就能全部吸收，可以先从框架和基本原理入手，跳过部分细节，后面再逐步深入。</p>
<h2 id="数学基础"><a href="#数学基础" class="headerlink" title="数学基础"></a>数学基础</h2><p>看前面的视频和书籍，对于很多从事应用开发的同学来说，可能最大的障碍就是对数学的恐惧。这种感觉大概就像没经历过算法训练的同学面对算法面试一样。其实，恐惧只要能直面它，那就一定能够克服掉。就好比在LeetCode这样的OJ平台刷完200道左右的题目，再去面试算法一样。以前觉得是天大的障碍，现在回过头来，也不觉得有什么了不起。<br>我个人的经验是，通过前面的视频和书籍已经对机器学习和深度学习有了基本的系统框架和原理认识，同时，也积累了对数学知识进行系统复习的强烈欲望。这时候就可以有的放矢的复习大学知识了。数学知识的复习，我都是通过看网易公开课来完成的。</p>
<h3 id="微积分"><a href="#微积分" class="headerlink" title="微积分"></a>微积分</h3><p>MIT《单变量微积分》：<a href="http://open.163.com/special/sp/singlevariablecalculus.html" target="_blank" rel="external">http://open.163.com/special/sp/singlevariablecalculus.html</a><br>虽说是MIT的课程，但坦白的讲，老师的节奏真是比国内的课程还要慢，真正做到了通俗易懂。<br>网易公开课还有MIT的《多变量微积分》，但我没有看，我觉得复习完单变量微积分，也就基本够用了。</p>
<h3 id="线性代数"><a href="#线性代数" class="headerlink" title="线性代数"></a>线性代数</h3><p>MIT《线性代数》<br><a href="http://open.163.com/special/opencourse/daishu.html" target="_blank" rel="external">http://open.163.com/special/opencourse/daishu.html</a><br>这门课就没有上面的《单变量微积分》那么Nice了，老师思路跳跃性很强，稍一走神就不知道讲到什么地方了 。但这门课有个很大的优点，就是从一开始就引入了向量空间的概念，而且贯穿始终。不像国内的课程，直到课程结束都以为线性代数只是求解方程组的另一种表达形式。</p>
<h3 id="概率-统计"><a href="#概率-统计" class="headerlink" title="概率 / 统计"></a>概率 / 统计</h3><p>可汗学院《概率》<br><a href="http://open.163.com/special/Khan/probability.html" target="_blank" rel="external">http://open.163.com/special/Khan/probability.html</a><br>可汗学院《统计学》<br><a href="http://open.163.com/special/Khan/khstatistics.html" target="_blank" rel="external">http://open.163.com/special/Khan/khstatistics.html</a><br>老实讲，可汗的公开课真是太细致了，细致到觉得拖沓（可能是复习，而不是初学者的缘故）。建议根据自己的需要做适当的跳跃。同时，两门课有部分内容是完全重合的，可以直接跳过。</p>
<h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><p>有了前面的基础相信你已经跃跃欲试了，但别急，工欲善其事必先利其器。可能你已经有MATLAB、C/C++、Java的编程经验，但建议再入手一款新武器-Python。虽然前面的语言也可以用于机器学习和深度学习相关的研究和开发，但Python的使用范围更广，参考资料也更加丰富。<br>我的自己经验是，</p>
<ul>
<li>1-在网上找一篇Python入门的帖子，搭建环境，运行简单的例子（半天）</li>
<li>2-找一本基础书籍，系统的熟悉下语言的基本特性和完整框架（1~2天）<br>ps：我之前有C/C++和Java的语音基础</li>
<li>3-开始正常使用Python进行开发，遇到问题，求助搜索引擎（2个月以上）</li>
<li>4-觉得自己对语言就基本的掌握后，可以根据选择进行进阶学习了<br>上面1~2天时间来系统的熟悉Python语言特性和语言框架的书籍我推荐，<br><strong>《Python基础教程》</strong><br>（这本书很厚，初期把目录扫完就可以了，后面当做字典来使用）</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-25ab68388a811102.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Python基础教程"></p>
<p>进阶阶段，推荐，<br><strong>《流畅的Python》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-80bedd75a383075d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="流畅的Python"></p>
<h2 id="动手实践"><a href="#动手实践" class="headerlink" title="动手实践"></a>动手实践</h2><h3 id="初级"><a href="#初级" class="headerlink" title="初级"></a>初级</h3><p>好了现在我们终于可以动手实践了，<br><strong>《Python机器学习及实践：从零开始通往Kaggle竞赛之路》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-56c0528a6f9e195c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Python机器学习及实践：从零开始通往Kaggle竞赛之路"><br>这是很薄的一本书，但对于初学者实践来说却是非常棒的一本书。书中的大多数算法都是基于sk-learn来实现的。使用现成的Python库，而不用关心具体算法实现过程，可以快速体验机器学习算法的效果。同时，书的最后比较细致的介绍了Kaggle竞赛平台的使用，实战性更强。</p>
<h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><p>《Python机器学习及实践：从零开始通往Kaggle竞赛之路》使用现成的Python库（工程中也大多是这样的）。但很多同学还是更希望能手工实现具体的算法，觉得这样基本功才扎实，那下面的这两本书就能很好的满足有这样想法的同学了。<br><strong>《机器学习实战》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-bfcf83388e932f2c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="机器学习实战"><br>经典的机器学习算法手工实现，书中包含大量的代码实例。但这本书出本的比较早，深度学习内容基本没有涉猎。针对这种情况，就有了下面这本的推荐，</p>
<p><strong>《TensorFlow Machine Learning Cookbook》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-8ecb1c36d881acfb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TensorFlow Machine Learning Cookbook"><br>这本书主要是基于TensorFlow的，手工编织网络。而且，书的内容就像它的名字一样，结构编排跟类似菜谱：开始前需要准备什么，开始后需要遵从哪些步骤，最后又会得到怎样的结果，条理非常清晰。目前这本书已经有了中文版。</p>
<h2 id="领域应用"><a href="#领域应用" class="headerlink" title="领域应用"></a>领域应用</h2><p>虽然我们花费了很长的时间，投入了很多精力，但我们目前的阶段仍然像做大学作业，跟真实的工业场景相差很远。那机器学习和深度学习在实际的AI场景是如何应用的呢？带着这样的问题，我推荐两本书，<br><strong>《数学之美》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-fe21d68dd379dfe2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数学之美"><br>吴军老师的经典之作。虽然这本书火的时候，AI都还没有现在这么火，但书中介绍的很多场景，使用的很多技术，基本都是来自我们学习的机器学习。</p>
<p><strong>《统计自然语言处理》</strong><br><img src="http://upload-images.jianshu.io/upload_images/4905018-02feed30f620107b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="统计自然语言处理"><br>选择这边书是因为自己当前的工作跟自然语言处理相关。当然了，这也是自然语言处理领域非常经典的一本书，内容全面丰富。但学术的气息比较重，读起来又找到了当初读研看Paper的感觉。</p>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><p>比较正统的学习基本就算介绍完毕了。其实，除了上面的主线内容外，很多比较零散的资料，对于学习来说也还是很有裨益的。<br><strong>《莫烦视频》</strong><br>莫烦的个人主页有很多机器学习和深度学习相关的个人录制视频。以非常简洁的方式介绍了机器学习和深度学习相关的概念和框架，对初学者快速建立概念很有帮助(PS:92年的小鲜肉，真是不得了)。<br>地址：<a href="https://morvanzhou.github.io/about/" target="_blank" rel="external">https://morvanzhou.github.io/about/</a><br><strong>《深度学习简化版》</strong><br>形式跟莫凡的视频类似，是老外录制的。相比于莫烦的视频，内容更丰富多样，形式更新颖。通过YouTube播放，需要翻墙。<br>地址：<a href="https://www.youtube.com/watch?list=PLjJh1vlSEYgvGod9wWiydumYl8hOXixNu&amp;v=b99UVkWzYTQ" target="_blank" rel="external">https://www.youtube.com/watch?list=PLjJh1vlSEYgvGod9wWiydumYl8hOXixNu&amp;v=b99UVkWzYTQ</a><br><strong>《AI技术内参》</strong><br>这是《极客时间》的一个付费专栏。主要推送AI相关的技术历史、当前行业信息和科研成果，从目前的使用情况来说，在品质上还是有保障的。</p>
<p>好啦，暂时就先这样吧，后面有更好的内容再更新，也欢迎大家分享自己的学习经验。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/Step-by-Step带你玩转DuerOS-DuerOS客户端架构设计-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/11/Step-by-Step带你玩转DuerOS-DuerOS客户端架构设计-6/" itemprop="url">
                  Step by Step带你玩转DuerOS - DuerOS客户端架构设计(6)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-11T21:44:23+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://www.jianshu.com/p/ab3ae8067bb8" target="_blank" rel="external">https://www.jianshu.com/p/ab3ae8067bb8</a></p>
<p>在前面的系列文章中，我们完整的分析了智能语音系统的系统组成，然后，我们提供了一个基于Python的DuerOS客户端供大家实际体验。这时候很多同学可能想：我能不能从零开始，完全的基于DuerOS提供的后台能力接口，用自己喜欢的语言（如C/C++、Java、ObjectC、Python、NodeJS），在自己熟悉的平台上（如Android、iOS、Linux、Windows、树莓派、单片机），自己独立完成DurOS的客户端开发呢？特别是对有产品化想法的同学，把DurOS的能力集成到自己的项目平台中。<br>这篇文章就跟大家一起来熟悉下DuerOS客户端实现的架构设计，主要是侧重对DuerOS客户端协议的解析（对于设备端开发过程中涉及到的更多细节，如AEC、采样率转换、音频焦点管理、混音处理），会在后面的文章中一一作出介绍和解析），希望这篇文章能对你的开发和工作有帮助。</p>
<h2 id="DuerOS客户端核心任务"><a href="#DuerOS客户端核心任务" class="headerlink" title="DuerOS客户端核心任务"></a>DuerOS客户端核心任务</h2><p>简单的说，客户端的主要任务就是，将用户的语音数据通过网络传给DuerOS后台，然后，执行DuerOS后台经过语音处理后的结果。<br>当然了如果，真是这么简单就好了~<br>具体的说，客户端需要完成的工作主要有，</p>
<ul>
<li>同DuerOS后台建立长链接，接收并处理DuerOS后台的推送命令（Directive）</li>
<li>上传用户录音数据到DuerOS后台服务器</li>
<li>执行上传录音后，DuerOS后台返回的控制命令（Directive）</li>
<li>上传设备事件[Event]到DuerOS后台服务端</li>
<li>通过Ping的方式保持链接<br>其中，<br>Directive：指DurOS服务端对客户端的控制命令，如播放一个语音，设置一个闹钟，播放一个音乐等等。<br>Event：指客户端上报当前发生的事件到DuerOS服务端，如音乐播放开始了，音乐播放结束了，闹铃开始响了，设备被唤醒并开始接受用户语音请求等等。在上传Event时，会附带设备当前的状态信息（ClientContext，如当前是否有音乐正在播放，播放到哪里了，设备端是否有设置闹铃，闹铃状态等等）。<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2>下面我们就结合具体场景和代码，逐个的来看各个部分是如何实现的。<br>分析场景:</li>
<li>用户语音输入“播放周杰伦的歌”</li>
<li>客户端上传用户的语音数据到DurOS后台服务器</li>
<li>DuerOS后台服务判断用户输入结束，下发停止录音Directive</li>
<li>客户端响应停止录音的Directive</li>
<li>客户端响应录音通道，服务端返回的需要播放歌曲的Directive</li>
<li>客户端上报开始音乐播放的状态到DuerOS后台服务器<h3 id="1-同DuerOS后台建立长链接，接收并处理DuerOS后台的推送命令（Directive）"><a href="#1-同DuerOS后台建立长链接，接收并处理DuerOS后台的推送命令（Directive）" class="headerlink" title="1. 同DuerOS后台建立长链接，接收并处理DuerOS后台的推送命令（Directive）"></a>1. 同DuerOS后台建立长链接，接收并处理DuerOS后台的推送命令（Directive）</h3>长链接主要实现DuerOS后台主动向客户端发送命令。比如，客户端一直向DuerOS后台发送数据，当DuerOS后台检测到用户输入结束时（VAD检测），DuerOS后台会主动通知客户端停止录音，并上传录音数据。<br>DuerOS的所有能力都是基于Http的（没有使用TCP/IP），为了实现长链接DuerOS的做法是：</li>
<li>客户端向DuerOS服务端发送get请求（设置较长的超时时间）</li>
<li>DuerOS服务端收到get请求后，并不立即回复</li>
<li>DuerOS服务端需要主动下发命令给客户端时，返回get结果</li>
<li>客户端通过接收get的返回内容，完成DuerOS服务端主动推动内容的接收<br>Python DuerOS客户端对应的代码实现(sdk/dueros_core.py)，<br><em>长链接建立：</em><br><img src="http://upload-images.jianshu.io/upload_images/4905018-4d9a1721507bebef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="长链接建立"></li>
</ul>
<p><em>DuerOS 下发Directive接收</em></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-536eeee3e75eb23c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DuerOS 下发Directive接收"></p>
<h3 id="2-上传用户录音数据到DuerOS后台服务器"><a href="#2-上传用户录音数据到DuerOS后台服务器" class="headerlink" title="2. 上传用户录音数据到DuerOS后台服务器"></a>2. 上传用户录音数据到DuerOS后台服务器</h3><p>上传用户录音数据不单单是用户说话的音频流PCM数据，同时包括设备的状态信息（ClientContext），和开始录音的Event（ListenStarted）。状态和数据发送通过Post完成，Http的Body内容如下所示，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-a353f89c6f568c45.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用户录音数据上传报文格式"></p>
<p>其中，ClientContext、Event、和音频流PCM通过multipart+chunk的Http Post方式进行上传（后面可能会添加一个帖子，专门介绍下Http 1.0、1.1、 2.0、multipart、chunk传输等内容）。<br>Python DuerOS客户端对应实现（sdk/dueros_core.py），<br><img src="http://upload-images.jianshu.io/upload_images/4905018-b12be3fba76cf350.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用户录音数据上传"></p>
<p>###3. 执行上传录音后，DuerOS后台返回的控制命令（Directive）<br>用户语音输入“播放周杰伦的音乐”后，语音上传通道会收到DuerOS后台服务器返回需要播放的音乐的Directive。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-3a61465f85971cfb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="录音上传后返回的Directive"></p>
<h3 id="4-客户端上传音乐开始播放的Event"><a href="#4-客户端上传音乐开始播放的Event" class="headerlink" title="4. 客户端上传音乐开始播放的Event"></a>4. 客户端上传音乐开始播放的Event</h3><p>音乐开始播放后，客户端上传音乐开始播放的Event到DuerOS服务端（sdk/interface/audio_player.py）<br><img src="http://upload-images.jianshu.io/upload_images/4905018-8fc5e96cec3343b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="上传音乐开始播放的Event"></p>
<h3 id="5-Ping"><a href="#5-Ping" class="headerlink" title="5. Ping"></a>5. Ping</h3><p>Ping主要为了链接的维护。Http 1.0中每次Http 请求都需要进行TCP/IP的3次握手和4次挥手，Http1.1后支持连接复用，一次TCP/IP连接可以完成多次Http请求和回复。DuerOS使用Http2.0，为了避免链路上长时间没有数据传输而断开，使用Ping维持链接。<br>sdk/dureos_core.py<br><img src="http://upload-images.jianshu.io/upload_images/4905018-bff62564fccc0d81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Ping"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="通路总结"><a href="#通路总结" class="headerlink" title="通路总结"></a>通路总结</h3><p>客户端同DuerOS服务端的通路一共有3个：</p>
<ul>
<li>长链接通路</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-d7be5cba60305187.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="长链接"></p>
<p>双向<br>客户端发送get请求<br>服务端通过get response的形式推送消息（如停止录音Directive）</p>
<ul>
<li>事件上报通路</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-a8b2d06e62454112.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="事件上报"></p>
<p>双向<br>客户端发送post请求（包含开始录音的Event、当前设备状态ClientContext、录音数据PCM）<br>服务端返回语音请求的结果（如播放歌曲的Directive）<br>客户端单独上传事件到DurOS服务端（如开始播放音乐）</p>
<ul>
<li>Ping通路</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-4ce59769a9bd22dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Ping"></p>
<p>单向<br>客户端通过get形式在链路没数据时发送Ping数据包</p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li>事件（Event）和设备当前状态（ClientContext）一定是一起发送的</li>
<li>Directive下发通道<br>长链接通道和事件上报通路（录音数据上传）都会下发Directive（如，长链接会下发停止录音的Directive，录音上传通道会下发包含音乐播放内容的音乐播放Directive）</li>
<li>Event上传通道<br>录音数据上传（包括开始录音Event、当前设备状态ClientContext和录音数据PCM）和单独的事件上报（如音乐开始播放）共用同一通道</li>
<li>Http技术细节<br>Http2.0特性<br>链接复用<br>MultiPart<br>Chunk<br>Ping连接维护<br>关于Http相关的技术细节后面专门写篇帖子吧</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/Step-by-Step带你玩转DuerOS-唤醒词替换-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/11/Step-by-Step带你玩转DuerOS-唤醒词替换-5/" itemprop="url">
                  Step by Step带你玩转DuerOS - 唤醒词替换(5)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-11T21:43:25+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://www.jianshu.com/p/96284d314cbe" target="_blank" rel="external">https://www.jianshu.com/p/96284d314cbe</a></p>
<p>当前Python版本的DuerOS只能通过[小度小度]进行唤醒。论坛里和群里很多同学问：“那如果我想通过[大白大白]，[叮当叮当]或者[你好]这样的自定义唤醒词来唤醒DuerOS改怎么做呢？”<br>自定义唤醒词其实超简单，下面我们就一步一步的来更换唤醒词。</p>
<h2 id="1-在snowboy平台训练自己的唤醒词"><a href="#1-在snowboy平台训练自己的唤醒词" class="headerlink" title="1 在snowboy平台训练自己的唤醒词"></a>1 在snowboy平台训练自己的唤醒词</h2><p>先附上snowboy的官方地址：<a href="https://snowboy.kitt.ai/" target="_blank" rel="external">https://snowboy.kitt.ai/</a></p>
<h3 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h3><p><img src="http://upload-images.jianshu.io/upload_images/4905018-58440cde7df17e4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="登陆入口"></p>
<h3 id="创建自定义的唤醒词"><a href="#创建自定义的唤醒词" class="headerlink" title="创建自定义的唤醒词"></a>创建自定义的唤醒词</h3><p><img src="http://upload-images.jianshu.io/upload_images/4905018-cc4cd746d64f2f3f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="自定义唤醒词创建"></p>
<h3 id="下载唤醒模型"><a href="#下载唤醒模型" class="headerlink" title="下载唤醒模型"></a>下载唤醒模型</h3><p>在线训练完成后，下载训练模型（本例中我的训练唤醒词为“小白”）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-dbc4a26ff06ca8dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="唤醒模型下载"></p>
<p>下载的模型为”小白.pmdl”</p>
<h2 id="2-下载snowboy-python接口代码"><a href="#2-下载snowboy-python接口代码" class="headerlink" title="2 下载snowboy python接口代码"></a>2 下载snowboy python接口代码</h2><p>snowboy GitHub地址: <a href="https://github.com/Kitt-AI/snowboy" target="_blank" rel="external">https://github.com/Kitt-AI/snowboy</a></p>
<h3 id="Clone-snowboy接口代码"><a href="#Clone-snowboy接口代码" class="headerlink" title="Clone snowboy接口代码"></a>Clone snowboy接口代码</h3><pre><code>git clone https://github.com/Kitt-AI/snowboy.git
</code></pre><h3 id="生成平台代码"><a href="#生成平台代码" class="headerlink" title="生成平台代码"></a>生成平台代码</h3><p>在snowboy/swig/Python目录执行“make”命令，<br><img src="http://upload-images.jianshu.io/upload_images/4905018-b5507aa8dd21c2f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="平台代码生成"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-d724412ee2566866.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="snowboy GitHub README.md"></p>
<h3 id="获得snowboy-python接口组件"><a href="#获得snowboy-python接口组件" class="headerlink" title="获得snowboy python接口组件"></a>获得snowboy python接口组件</h3><p>将snowboy/examples目录下的Python目录更名为snowboy</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-e2c29285cf7603ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="3-Python-DuerOS-SDK代码更新"><a href="#3-Python-DuerOS-SDK代码更新" class="headerlink" title="3 Python DuerOS SDK代码更新"></a>3 Python DuerOS SDK代码更新</h2><p>有了上面的定制唤醒模型（小白.pmdl）和snowboy python接口组件，下面就可以更新Python DuerOS SDK的代码了。</p>
<h3 id="Python-DuerOS-中的app-snowboy目录内容更新"><a href="#Python-DuerOS-中的app-snowboy目录内容更新" class="headerlink" title="Python DuerOS 中的app/snowboy目录内容更新"></a>Python DuerOS 中的app/snowboy目录内容更新</h3><p>先删除Python DuerOS中的app/snowboy文件夹，然后再将步骤2中生成的snowboy文件夹拷贝到app/目录下，然后，将训练好的唤醒模型（小白.pmdl）拷贝到app/snowboy目录中。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-80b8c64b0d2fa0e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="snowboy目录"></p>
<h3 id="修改app-snowboy-snowboydecoder-py"><a href="#修改app-snowboy-snowboydecoder-py" class="headerlink" title="修改app/snowboy/snowboydecoder.py"></a>修改app/snowboy/snowboydecoder.py</h3><p>####[1]修改<strong> init </strong>（）函数<br>注释掉self.audio和self.stream_in<br><img src="http://upload-images.jianshu.io/upload_images/4905018-a73a594a7cc51d03.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="__init__"></p>
<h4 id="2-添加feed-data-方法"><a href="#2-添加feed-data-方法" class="headerlink" title="[2] 添加feed_data()方法"></a>[2] 添加feed_data()方法</h4><p><img src="http://upload-images.jianshu.io/upload_images/4905018-d8ce8225ea35022d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加feed_data()方法"></p>
<p>####[3] 修改terminate()方法</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-e144901202d0d27b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="更新terminate()方法"></p>
<h3 id="修改app-wakeup-trigger-main-py"><a href="#修改app-wakeup-trigger-main-py" class="headerlink" title="修改app/wakeup_trigger_main.py"></a>修改app/wakeup_trigger_main.py</h3><p>在main()方法中更新唤醒模型，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-0f557429b6e0b5c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="唤醒模型更新"></p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>经过上面的步骤，我们便能够更新成自己喜欢的唤醒词。但我们自定义的唤醒词还不是完美的。在测试中会发现唤醒率并不高。根本的原因在于我们自定义的唤醒词，训练语料条太少了（可能只有1组，3条）。要达到一个很好的唤醒率，需要进行大量丰富的语音样本训练才行。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-df186f9817c59151.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="训练样本"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/Step-by-Step带你玩转DuerOS-OAuth2-0全面解析-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/11/Step-by-Step带你玩转DuerOS-OAuth2-0全面解析-4/" itemprop="url">
                  Step by Step带你玩转DuerOS - OAuth2.0全面解析 (4)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-11T21:42:32+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://www.jianshu.com/p/c0219b8a50cd" target="_blank" rel="external">https://www.jianshu.com/p/c0219b8a50cd</a></p>
<p>DuerOS的开发平台在创建产品时，有一步需要进行OAuth设置（<a href="http://open.duer.baidu.com/doc/overall/console-guide_markdown" target="_blank" rel="external">http://open.duer.baidu.com/doc/overall/console-guide_markdown</a>），<br><img src="http://upload-images.jianshu.io/upload_images/4905018-60bba90bdfea249e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DuerOS OAuth配置"><br>很多同学到这个步骤估计会很困惑，OAuth是什么？这里设置的URL有是什么呢？那我们这篇文章就好好讲一讲OAuth到底是什么？在DuerOS的接入过程中又是怎么使用的。</p>
<h2 id="什么是OAuth"><a href="#什么是OAuth" class="headerlink" title="什么是OAuth"></a>什么是OAuth</h2><p> 其实OAuth在我们日常中是非常常见的，但可能你没有专门的关注过功能背后的实现原理。这里有一篇阮一峰老师专门介绍OAuth的文章《理解OAuth 2.0》(<a href="http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html</a>)，这是我目前为止见得对OAuth讲解最浅显又是最全面的一篇（ps 阮一峰老师的文章质量都很高呀）。</p>
<h2 id="DuerOS是如何使用OAuth的"><a href="#DuerOS是如何使用OAuth的" class="headerlink" title="DuerOS是如何使用OAuth的"></a>DuerOS是如何使用OAuth的</h2><p>OAuth有4中授权模式，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-ef5c25357e5d5e5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="OAuth授权模式"></p>
<p>而DuerOS使用的便是其中功能最完整、流程最严密的授权码模式。下面我们通过Python版本的DuerOS客户端来分析下DuerOS对OAuth的使用。</p>
<h3 id="认证流程组成单元"><a href="#认证流程组成单元" class="headerlink" title="认证流程组成单元"></a>认证流程组成单元</h3><p>授权码模式的认证流程如下所示，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-ec351bc35c5ffe90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="授权码模式认证流程"></p>
<p>主要涉及到4个基本单元：</p>
<ul>
<li>A-用户客户端</li>
<li>B-用户端浏览器（完成URI重定向）</li>
<li>C-用户客户端对应的后台服务器</li>
<li>D-认证服务器</li>
</ul>
<p>针对于DuerOS Python客户端，A、B、C、D分别对应：</p>
<ul>
<li>A-auth.sh（app/auth.py）</li>
<li>B-系统浏览器</li>
<li>C-app/auth.py中创建的Tornado WebServer</li>
<li><p>D-百度的认证服务器</p>
<h3 id="OAuth认证流程"><a href="#OAuth认证流程" class="headerlink" title="OAuth认证流程"></a>OAuth认证流程</h3><p>下面我们结合代码，一步一步的解析OAuth的整个过程<br>####1.用户客户端（A）对应的后台服务器（C）创建<br>运行，</p>
<h1 id="auth-sh"><a href="#auth-sh" class="headerlink" title="./auth.sh"></a>./auth.sh</h1><p>Python客户端会创建一个本地的Tornado WebServer，</p>
</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-2d971c3a33e20398.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Tornado WebServer创建（app/auth.py）"></p>
<p>这个Tornado WebServer只是为了调试方便被部署在本地，实际项目应用中会作为独立的Web服务，部署在云端的。</p>
<h4 id="2-客户端（A）吊起本地浏览器（B）访问客户端对应的后台服务器（C）"><a href="#2-客户端（A）吊起本地浏览器（B）访问客户端对应的后台服务器（C）" class="headerlink" title="2. 客户端（A）吊起本地浏览器（B）访问客户端对应的后台服务器（C）"></a>2. 客户端（A）吊起本地浏览器（B）访问客户端对应的后台服务器（C）</h4><p>好像有些绕（汗。。。）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-011f163eefc61fc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="app/auth.py"></p>
<p>其中，URL（<a href="http://127.0.0.1:3000）就是客户端对应的后台服务器（C）的地址。" target="_blank" rel="external">http://127.0.0.1:3000）就是客户端对应的后台服务器（C）的地址。</a></p>
<h4 id="3-客户端对应的后台服务器（C）通过重定向的方式让客户端浏览器（B）对百度认证服务器（D）发送认证请求"><a href="#3-客户端对应的后台服务器（C）通过重定向的方式让客户端浏览器（B）对百度认证服务器（D）发送认证请求" class="headerlink" title="3. 客户端对应的后台服务器（C）通过重定向的方式让客户端浏览器（B）对百度认证服务器（D）发送认证请求"></a>3. 客户端对应的后台服务器（C）通过重定向的方式让客户端浏览器（B）对百度认证服务器（D）发送认证请求</h4><p>哎，好像更绕了（再汗。。。）</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-c2c2be2650e19f54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="app/auth.py"></p>
<p>####4. 百度认证服务器（D）向客户端浏览器（B）返回用户登录页面<br><img src="http://upload-images.jianshu.io/upload_images/4905018-2ba2989d06355468.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="用户登录页面"></p>
<p>前面的步骤，用户客户端（A）、用户客户端对应的后台服务器（C）、百度认证服务器（D），三者之间的通信都需要客户端浏览器（B）进行重定向做请求转发。这样的过程是不是感觉很困惑呢？为啥非要通过浏览器（B）来做重定向请求转发呢？为啥不直接进行Http请求呢？<br>现在看到这个页面应该有答案了吧：需要由浏览器（B）来展示来自百度认证服务器（D）的认证页面，并完成用户身份认证的交互。</p>
<p>####5. 百度认证服务器（D）将授权码通过客户端浏览器（B）转发给客户端对应的后台服务器（C）<br>用户在第4步中输入账号、密码后，点击登录并授权。百度的认证服务器（D）会收到用户登录请求，然后将授权码通过客户端浏览器（B）重定向的方式发送给客户端对应的后台服务器（C）。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-ee62c52781a71782.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="app/auth.py"></p>
<h4 id="6-客户端后台服务器（C）通过授权码向百度认证服务器（D）请求Token"><a href="#6-客户端后台服务器（C）通过授权码向百度认证服务器（D）请求Token" class="headerlink" title="6. 客户端后台服务器（C）通过授权码向百度认证服务器（D）请求Token"></a>6. 客户端后台服务器（C）通过授权码向百度认证服务器（D）请求Token</h4><p>客户端后台服务器（C）通过上一步获得的授权码向百度认证服务器（D）请求授权，并获取Token，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-21b5df4a851d3fda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="app/auth.py"></p>
<h4 id="7-用户客户端（A）从客户端的后台服务器（C）中获取Token"><a href="#7-用户客户端（A）从客户端的后台服务器（C）中获取Token" class="headerlink" title="7. 用户客户端（A）从客户端的后台服务器（C）中获取Token"></a>7. 用户客户端（A）从客户端的后台服务器（C）中获取Token</h4><p>由于Python DuerOS客户端中的后台服务器（Tornado WebServer）就在本地，所以，Token可以直接获得，</p>
<h4 id="8-token使用"><a href="#8-token使用" class="headerlink" title="8. token使用"></a>8. token使用</h4><p>千辛万苦通过OAuth流程获取的Token其实在DuerOS的后续请求中只是一个字段而已，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-9f955b8fbdc3c4b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="请求中的token字段"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/Step-by-Step带你玩转DuerOS-Python-DuerOS-SDK-树莓派平台-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/11/Step-by-Step带你玩转DuerOS-Python-DuerOS-SDK-树莓派平台-3/" itemprop="url">
                  Step by Step带你玩转DuerOS - Python DuerOS SDK[树莓派平台] (3)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-11T21:41:26+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://www.jianshu.com/p/e689d770d99d" target="_blank" rel="external">https://www.jianshu.com/p/e689d770d99d</a></p>
<p>在前一个帖子中，给大家带来了Python版本的DuerOS SDK。但DuerOS的测试环境却声明为Ubuntu，相信很多同学会疑惑：Python不是跨平台的吗？为什么要限制测试平台呢？真实的情况呢是这样的：<br>首先，Python跨平台这个没毛病。但问题在于DuerOS运行所需要的依赖环境确实跟平台相关的。比如DuerOS是基于Http2 ALPN的，但树莓派官方镜像的OpenSSL并不支持，而对应的Python库依赖于OpenSSL。为了在树莓派平台上支持Python的DuerOS SDK，专门交叉编译了OpenSSL和Python。<br>所以，这里限制了平台主要是方便同学能将DuerOS快速的Run起来。当然，如果想在MacOS、Windows平台运行DuerOS Python SDK也是没问题的，只是在依赖配置方面可能要多花些时间。<br>好了，废话不多说，直接上干货：</p>
<h1 id="树莓派DuerOS-Python-版本支持"><a href="#树莓派DuerOS-Python-版本支持" class="headerlink" title="树莓派DuerOS Python 版本支持"></a>树莓派DuerOS Python 版本支持</h1><p>##准备<br>按照个人版使用说明完成如下3步（<a href="http://open.duer.baidu.com/doc/device-devkit/intro_markdown" target="_blank" rel="external">http://open.duer.baidu.com/doc/device-devkit/intro_markdown</a>）</p>
<ul>
<li>镜像下载，烧录安装</li>
<li>配网</li>
<li>验证“小度小度”</li>
</ul>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><ol>
<li><p>停止现有小度功能，因为会占用MIC资源</p>
<pre><code>sudo systemctl disable duer
sudo systemctl stop duer
</code></pre></li>
<li><p>安装依赖包</p>
<pre><code>sudo apt-get update
sudo apt-get install python-dateutil
sudo apt-get install gir1.2-gstreamer-1.0
sudo apt-get install python-pyaudio
sudo apt-get install libatlas-base-dev
sudo apt-get install python-dev        
sudo pip install tornado
sudo pip install hyper
</code></pre><p>hyper库用来支持http2.0 client, pyaudio用来支持录音，tornado用来完成oauth认证。</p>
</li>
<li><p>下载编译好的openssl和Python安装包，并进行安装, <strong>需要更新openssl才能支持python sdk的使用</strong>。</p>
<pre><code>*从如下地址下载openssl安装包*(链接: https://pan.baidu.com/s/1skAP6WH 密码: wknz)
*从如下地址下载python2.7.14安装包*(链接: https://pan.baidu.com/s/1o8MHkzK 密码: ngx4)

 tar -zxvf openssl1.1.tar.gz -C /usr
 tar -zxvf python2.7.14.tar.gz -C /usr/local/
 sudo rm -rf /usr/bin/python
 sudo ln -s /usr/local/python2.7.14/bin/python /usr/bin/python
</code></pre></li>
<li><p>下载Python SDK和参考示例代码</p>
<pre><code>git clone https://github.com/MyDuerOS/DuerOS-Python-Client.git
cd DuerOS-Python-Client
git checkout raspberry-dev
</code></pre></li>
</ol>
<p>##运行和测试</p>
<ol>
<li><p>授权</p>
<pre><code>./auth.py
</code></pre><p>直接运行使用默认的client_id和client_secret，开发者可以替换成自己在DuerOS开放平台申请的client_id和client_secret，进而实现在控制台自定义的配置属性。</p>
</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-b8e7c555be24d4fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="app/auth.py"></p>
<p>其中，<br>需要在开放平台中“安全设置”的“授权回调页”，设置成  </p>
<pre><code>http://127.0.0.1:3000/authresponse
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/4905018-caca627041b10380.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="授权回调页设置"></p>
<ol>
<li><p>唤醒加识别</p>
<pre><code>./wakeup_trigger_start.sh
</code></pre></li>
<li><p>enter按键触发识别</p>
<pre><code>./enter_trigger_start.sh
</code></pre></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/11/Step-by-Step带你玩转DuerOS-DuerOS能力初体验-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/11/Step-by-Step带你玩转DuerOS-DuerOS能力初体验-2/" itemprop="url">
                  Step by Step带你玩转DuerOS - DuerOS能力初体验(2)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-11T21:33:42+08:00">
                2017-11-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于图片外链被禁止了，图片不能显示，完整文章看这里吧：<a href="https://www.jianshu.com/p/267334be6954" target="_blank" rel="external">https://www.jianshu.com/p/267334be6954</a></p>
<p>有了前面两篇文章的介绍，相信大家已经跃跃欲试了，想最快的体验DuerOS的能力？那当然是下载DuerOS App啦，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-dc6b78232b08c78a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="度秘App"></p>
<p>如果想在硬件上体验，可以尝试树莓派版本，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-fbd911a8fa84a6ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="基于树莓派的个人开发套件"></p>
<p>项目地址：<a href="http://open.duer.baidu.com/doc/device-devkit/intro_markdown" target="_blank" rel="external">http://open.duer.baidu.com/doc/device-devkit/intro_markdown</a></p>
<p>但不论是手机端的App还是基于树莓派的个人开发套件，但都有一个开发者不能忍缺陷：只能“看”，不能“玩”。作为机智神勇的开发者，肯定需要能定制、能修改、能改造的。</p>
<h1 id="新的选择"><a href="#新的选择" class="headerlink" title="新的选择"></a>新的选择</h1><p>针对上面的情况，这里提供了一个Python版本的DuerOS。<br>项目地址：<a href="https://github.com/MyDuerOS/DuerOS-Python-Client" target="_blank" rel="external">https://github.com/MyDuerOS/DuerOS-Python-Client</a><br>之所以选择Python主要出于以下方面的考量：</p>
<ul>
<li>简单易学，即便是没有编程经验的同学也能快速上手</li>
<li>环境搭建简单，避免各种编译、链接问题</li>
<li>AI时代必备技能，AI时代你还不会Python？</li>
</ul>
<p>当前版本支持功能：</p>
<ul>
<li>完成OAuth 2.0认证</li>
<li>通过[Enter]键触发唤醒状态</li>
<li>支持天气、百科等TTS播放功能</li>
<li>支持音乐播放功能</li>
<li>支持闹铃功能</li>
<li>云端下发Directive显示</li>
</ul>
<p>后续会支持跟多的功能，比如，</p>
<ul>
<li>[小度，小度]语音唤醒</li>
<li>接入百度的技能平台，完成自定义功能</li>
</ul>
<p>希望大家把使用过程中遇到的问题提出来，便于后续的优化</p>
<h1 id="DuerOS-Python-Client使用说明"><a href="#DuerOS-Python-Client使用说明" class="headerlink" title="DuerOS-Python-Client使用说明"></a>DuerOS-Python-Client使用说明</h1><h2 id="运行依赖"><a href="#运行依赖" class="headerlink" title="运行依赖"></a>运行依赖</h2><ul>
<li>gstreamer1.0</li>
<li>gstreamer1.0-plugins-good</li>
<li>gstreamer1.0-plugins-ugly</li>
<li>python-gi</li>
<li>python-gst</li>
<li>gir1.2-gstreamer-1.0<h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2></li>
<li>Ubuntu 16.04</li>
<li><p>Python 2.7.12</p>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="项目获取"><a href="#项目获取" class="headerlink" title="项目获取"></a>项目获取</h3><p>通过git下载代码到本地</p>
<h1 id="git-clone-https-github-com-MyDuerOS-DuerOS-Python-Client-git"><a href="#git-clone-https-github-com-MyDuerOS-DuerOS-Python-Client-git" class="headerlink" title="git clone https://github.com/MyDuerOS/DuerOS-Python-Client.git"></a>git clone <a href="https://github.com/MyDuerOS/DuerOS-Python-Client.git" target="_blank" rel="external">https://github.com/MyDuerOS/DuerOS-Python-Client.git</a></h1></li>
</ul>
<h3 id="认证授权"><a href="#认证授权" class="headerlink" title="认证授权"></a>认证授权</h3><p>在DuerOS-Python-Client目录下执行</p>
<pre><code># ./auth.sh
</code></pre><h3 id="通过-Enter-键触发唤醒状态"><a href="#通过-Enter-键触发唤醒状态" class="headerlink" title="通过[Enter]键触发唤醒状态"></a>通过[Enter]键触发唤醒状态</h3><p>在DuerOS-Python-Client目录下执行</p>
<pre><code># ./enter_trigger_start.sh
</code></pre><p>然后，每次单击[Enter]键后进行语音输入</p>
<h3 id="通过-小度小度-触发唤醒状态"><a href="#通过-小度小度-触发唤醒状态" class="headerlink" title="通过[小度小度]触发唤醒状态"></a>通过[小度小度]触发唤醒状态</h3><p>在DuerOS-Python-Client目录下执行(暂时该功能还不支持)</p>
<pre><code># ./wakeup_trigger_start.sh
</code></pre><p>然后，每次通过[小度小度]进行唤醒，然后，进行语音输入</p>
<h2 id="代码结构"><a href="#代码结构" class="headerlink" title="代码结构"></a>代码结构</h2><p>DuerOS-Python-Client代码结构如下图所示，</p>
<p><img src="http://upload-images.jianshu.io/upload_images/4905018-159f48b317d7dcce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="代码结构 "></p>
<p>其中，</p>
<p><em>DuerOS-Python-Client:项目根目录</em></p>
<ul>
<li>DuerOS-Python-Client/auth.sh:认证授权脚本</li>
<li>DuerOS-Python-Client/enter_trigger_start.sh:[Enter]按键触发唤醒脚本</li>
<li>DuerOS-Python-Client/wakeup_tirgger_start.sh:[小度小度]触发唤醒脚本</li>
</ul>
<p><em>DuerOS-Python-Client/app:应用目录</em></p>
<ul>
<li>DuerOS-Python-Client/app/auth.py:认证授权实现模块</li>
<li>DuerOS-Python-Client/app/enter_trigger_main.py:[Enter]按键触发唤醒实现模块</li>
<li>DuerOS-Python-Client/app/wakeup_tirgger_main.py:[小度小度]触发唤醒实现模块</li>
<li>DuerOS-Python-Client/app/framework:平台相关目录</li>
<li>DuerOS-Python-Client/app/framework/mic.py:录音模块(基于pyaudio)</li>
<li>DuerOS-Python-Client/app/framework/player.py:播放模块(基于GStreamer)</li>
<li>DuerOS-Python-Client/app/snowboy:snowboy唤醒引擎</li>
</ul>
<p><em>DuerOS-Python-Client/sdk:dueros sdk目录</em></p>
<ul>
<li>DuerOS-Python-Client/sdk/auth.py:授权相关实现</li>
<li>DuerOS-Python-Client/sdk/dueros_core.py:dueros交互实现</li>
<li>DuerOS-Python-Client/sdk/interface:端能力接口实现</li>
</ul>
<h2 id="SDK接口说明"><a href="#SDK接口说明" class="headerlink" title="SDK接口说明"></a>SDK接口说明</h2><h3 id="授权模块-sdk-auth"><a href="#授权模块-sdk-auth" class="headerlink" title="授权模块(sdk/auth)"></a>授权模块(sdk/auth)</h3><h4 id="授权接口"><a href="#授权接口" class="headerlink" title="授权接口"></a>授权接口</h4><p>用户通过授权接口完成基于OAuth2.0的认证授权流程</p>
<pre><code>def auth_request(client_id=CLIENT_ID, client_secret=CLIENT_SECRET):
&apos;&apos;&apos;
发起认证
:param client_id:开发者注册信息
:param client_secret: 开发者注册信息
:return:
&apos;&apos;&apos;
</code></pre><h3 id="DuerOS核心模块-sdk-dueros-core"><a href="#DuerOS核心模块-sdk-dueros-core" class="headerlink" title="DuerOS核心模块(sdk/dueros_core)"></a>DuerOS核心模块(sdk/dueros_core)</h3><h4 id="directive监听注册"><a href="#directive监听注册" class="headerlink" title="directive监听注册"></a>directive监听注册</h4><p>通过监听注册接口，用户可以获得云端下发的directive内容</p>
<pre><code>def set_directive_listener(self, listener):
&apos;&apos;&apos;
directive监听器设置
:param listener: directive监听器
:return:
&apos;&apos;&apos;
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/30/Step-by-Step带你玩转DuerOS-智能语音系统的系统组成（1）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/30/Step-by-Step带你玩转DuerOS-智能语音系统的系统组成（1）/" itemprop="url">
                  Step-by-Step带你玩转DuerOS-智能语音系统的系统组成（1）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-30T16:50:00+08:00">
                2017-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一个完整的智能语音系统主要由如下几个核心部分组成：</p>
<ul>
<li>麦克风阵列</li>
<li>唤醒识别</li>
<li>语音识别（ASR）</li>
<li>自然语言处理（NLP/NLU）</li>
<li>内容召回<br>下面我们逐个介绍各个组成部分<h1 id="麦克风阵列"><a href="#麦克风阵列" class="headerlink" title="麦克风阵列"></a>麦克风阵列</h1>麦克风用来将模拟的声音信号转换为数字信号，核心器件是ADC（Analog to Digital Controller）控制器，我们在日常生活中常见的麦克风大多是单麦克风，外形如下图所示：</li>
</ul>
<p><img src="/2017/09/30/Step-by-Step带你玩转DuerOS-智能语音系统的系统组成（1）/singlemic.png" alt="单麦克风"></p>
<p>而在智能语音系统中，大多使用麦克风阵列，外形如下图所示：</p>
<p><img src="/2017/09/30/Step-by-Step带你玩转DuerOS-智能语音系统的系统组成（1）/multimic.png" alt="麦克风阵列"><br>麦克风阵列在硬件上可以简单的理解成，一个麦克风阵列由多个麦克风组成。图中的麦克风阵列，每个红框就是一个麦克风。<br>麦克风阵列和普通的单麦克风相比有什么样的优点和缺点呢？</p>
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><p>首先麦克风阵列具有更好的远场拾音效果，举个不太严谨的例子，使用单麦克风打电话，手机需要放在半米的范围之内，对方才能听清说话的声音；但使用麦克风阵列，手机放在3~5米的范围之内，对方也能清晰的听到语音。<br>其次，麦克风阵列能够获取声源的角度信息，也就是说能够辨别声音的来源，但单麦克风做不到。<br>所以，在大多的智能语音系统中均采用麦克风阵列，而百度的DuerOS个人开发套件使用的就是麦克风阵列（包含两个麦克风）。</p>
<h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>最显著的缺点就是麦克风阵列的成本相比于单麦克风而言，价格会高出很多。</p>
<h2 id="技术点"><a href="#技术点" class="headerlink" title="技术点"></a>技术点</h2><ul>
<li>麦克风选型：驻极体/数字麦克风</li>
<li>麦克风一致性</li>
<li>AEC</li>
<li>波束合成</li>
<li>盲源分离<br>对具体的技术细节感兴趣的同学可以逐条了解下，这里就不逐一展开了。<h1 id="语音唤醒"><a href="#语音唤醒" class="headerlink" title="语音唤醒"></a>语音唤醒</h1>语音唤醒的常见场景就是用户使用唤醒词（如百度的“小度小度”，亚马逊的“Alex”）将设备激活。<br>实际上设备在通过唤醒词激活之前也是一直在工作的，设备一直在录音，并检查录音的数据中是否包含预设的唤醒词（如“小度小度”、“Alexa”），当检测到有唤醒词，设备便进入唤醒状态。<br>当前对于个人开发者相对友好的免费的唤醒引擎主要有：</li>
<li>SnowBoy (<a href="https://snowboy.kitt.ai/" target="_blank" rel="external">https://snowboy.kitt.ai/</a>)</li>
<li>Pocketsphinx (<a href="https://cmusphinx.github.io/wiki/tutorialpocketsphinx/" target="_blank" rel="external">https://cmusphinx.github.io/wiki/tutorialpocketsphinx/</a>)</li>
<li>Sensory (<a href="http://www.sensory.com" target="_blank" rel="external">http://www.sensory.com</a>)<br>目前，百度已全资收购了KITTAI（SnowBoy是KITTAI旗下产品），建议开发者直接使用SnowBoy作为唤醒引擎，同时，SnowBoy的唤醒词训练，及唤醒引擎的集成使用也很简洁方便。<h2 id="语音识别（ASR）"><a href="#语音识别（ASR）" class="headerlink" title="语音识别（ASR）"></a>语音识别（ASR）</h2>语音识别（ASR）简单的说就是讲语音转化为文本，目前几乎所有的语音系统都是先将语音转化为文本，然后再基于文本进行后续的语义理解和处理的。<h2 id="自然语言处理（NLP-NLU）"><a href="#自然语言处理（NLP-NLU）" class="headerlink" title="自然语言处理（NLP/NLU）"></a>自然语言处理（NLP/NLU）</h2>有了语言识别（ASR）获取的文本信息，后面就进入了自然语言处理单元了，可以说这个步骤是最接近我们概念上理解的人工智能了。这个部分会从输入文本中获取用户的意图和对应的关键信息。举个例子，对应用户输入请求：“我想听周杰伦的歌”，NLU会将请求拆解成如下的结构化结果：</li>
<li>意图：听歌</li>
<li>词槽：周杰伦<br>有了NLU的处理结果，就可以获取用户请求的结果了。<h2 id="内容召回"><a href="#内容召回" class="headerlink" title="内容召回"></a>内容召回</h2>假设你有两个资源库，其中，一个是电影库，一个是歌曲库。当接收NLU的处理结果后，从意图（听歌）上，你可以判别用户希望从歌曲库中获取资源，从词槽（周杰伦）可以判断用户想听歌曲的类别。有了意图和词槽就能从资源库中检索到用户期望的结果，并将结果按请求的路径返回。<h1 id="完整过程"><a href="#完整过程" class="headerlink" title="完整过程"></a>完整过程</h1>下面我们将上面的各个核心部分连贯起来，想象茶几上放着一个智能音响，用户坐在两米外的沙发上，用户通过语音发出请求“小度小度”，音响的提示灯亮起指示激活状态，用户说“我想听周杰伦的歌”，稍后，音响播放周杰伦的青花瓷。</li>
<li>满足远场（3~5米）拾音：麦克风阵列</li>
<li>提示灯亮起指示设备激活：唤醒引擎</li>
<li>语音请求转化为文本：语音识别（ASR）</li>
<li>从文本中识别出意图（听歌）和词槽（周杰伦）：自然语言处理（NLU）</li>
<li>通过意图和词槽返回结果：内容召回</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/30/Step-by-Step带你玩转DuerOS-写在最前面（0）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/30/Step-by-Step带你玩转DuerOS-写在最前面（0）/" itemprop="url">
                  Step-by-Step带你玩转DuerOS-写在最前面（0）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-30T16:44:54+08:00">
                2017-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>07年之前的互联网时代，我们习惯于借助键盘鼠标跟智能设备进行交互；07年之后的移动互联网时代，我们习惯于借助触摸屏跟智能设备进行交互；如今人工智能技术逐渐成熟，借助智能语音交互系统，我们可通过自然的语音交互来控制设备，实现打电话、听音乐，看电视的需求。相信不久的将来，人和设备的对话交互会变成最自然的输入方式，变成生活中自然的习惯。那么，有没有可能我们自己打造一个属于自己的语音个人助手呢？比如，通过语音来控制家里的灯，风扇，帮我们做日程管理。答案是肯定的，借助DuerOS的能力，普通的开发者也能打造属于自己的个人语音助手。</p>
<h1 id="DuerOS开发当前面临的问题"><a href="#DuerOS开发当前面临的问题" class="headerlink" title="DuerOS开发当前面临的问题"></a>DuerOS开发当前面临的问题</h1><p>虽然DuerOS的新闻铺天盖地，但DuerOS具体是怎样的一种形态？具有怎样的能力？DuerOS的开发者网站有很多详细的信息，但对于普通的开发者又该如何开始使用DuerOS呢？是不是你也和我一样有如下的困惑呢？</p>
<ul>
<li>智能语音系统是如何组成的？麦克风阵列、AEC、唤醒、ASR、VAD、NLU、自定义Bot是什么意思？</li>
<li>百度的DuerOS从开发者的角度看，是怎样的一种形态？能够提供怎样的能力？</li>
<li>亚马逊的AVS是什么？百度的AVS兼容协议是什么？百度的DCS协议跟前两者又有什么区别？</li>
<li>认证授权是什么？OAuth2.0是什么？</li>
<li>Http2.0是什么？为什么选择Http2.0，而不是Http1.1或Http1.0？</li>
<li>什么是设备发现？什么是配网？什么是登陆？</li>
<li>DuerOS中的长链接建立，Ping机制，Directive下发，Event上传是什么？<h1 id="这个博客系列会包含哪些内容"><a href="#这个博客系列会包含哪些内容" class="headerlink" title="这个博客系列会包含哪些内容"></a>这个博客系列会包含哪些内容</h1>这个博客系列主要针对初级的开发者，一步一步的展示一个基于DuerOS平台的智能语音交互系统具体实现，在实现的过程中也会逐步解释背后的实现原理。希望能够通过这个博客系列，普通的开发者能够顺利搭建属于自己的智能语音系统。<h1 id="技术要求"><a href="#技术要求" class="headerlink" title="技术要求"></a>技术要求</h1></li>
<li>硬件平台：树莓派3B+DuerOS阵列版</li>
<li>编程语言：Python<h1 id="当前进度"><a href="#当前进度" class="headerlink" title="当前进度"></a>当前进度</h1>目前已经基于DuerOS的DCS协议实现了Python版本的初级原型<a href="https://github.com/MyDuerOS/MyAssistant" target="_blank" rel="external">https://github.com/MyDuerOS/MyAssistant</a><br>目前还存在一些问题，比如使用SnowBoy训练”小度小度”唤醒词，训练样本太少，唤醒不怎么灵敏，后期会逐步完善。<h1 id="后期规划"><a href="#后期规划" class="headerlink" title="后期规划"></a>后期规划</h1>后期会从零开始搭建基于DuerOS的智能语音助手，大概会遵从如下的步骤：</li>
<li>智能语音系统的系统组成</li>
<li>DuerOS开发者个人注册</li>
<li>树莓派硬件环境搭建</li>
<li>DuerOS系统组成</li>
<li>OAuth2.0认证授权</li>
<li>DuerOS中长链接建立，Ping机制，Directive下发，Event上传</li>
<li>设备发现，配网，认证</li>
<li>自定义Bot认证<br>欢迎搭建提出更多的问题，我会在后续的博客中进行补充。<h1 id="项目git地址："><a href="#项目git地址：" class="headerlink" title="项目git地址："></a>项目git地址：</h1><a href="https://github.com/MyDuerOS" target="_blank" rel="external">https://github.com/MyDuerOS</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/30/基于word2vec的词语相似度计算/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liu Caiquan">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="才权的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/30/基于word2vec的词语相似度计算/" itemprop="url">
                  基于word2vec的词语相似度计算
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-30T16:37:28+08:00">
                2017-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h1><p>假设你有一个商品的数据库，比如：</p>
<table>
<thead>
<tr>
<th>商品名称</th>
<th>价格 </th>
</tr>
</thead>
<tbody>
<tr>
<td>椅子</td>
<td>200元/个</td>
</tr>
<tr>
<td>香蕉</td>
<td>6元/斤</td>
</tr>
<tr>
<td>冰箱</td>
<td>2000元/台</td>
</tr>
</tbody>
</table>
<p>现在通过用户的输入来检索商品的价格，最简单的方法就是通过字符串进行匹配，比如，<br>用户输入“椅子”，就用“椅子”作为关键字进行搜索，很容易找到椅子的价格就是200元/个。<br>但有时用户输入的是“凳子”，如果按照字符串匹配的方法，只能返回给用户，没有此商品。但实际上可以把“椅子”的结果返回给用户参考。这种泛化的能力，通过简单的字符串匹配是显然不能实现的。</p>
<h1 id="词语相似度计算"><a href="#词语相似度计算" class="headerlink" title="词语相似度计算"></a>词语相似度计算</h1><p>在上面的例子中，“凳子”跟“椅子”的语意更相近，跟“香蕉”或“冰箱”的语意相对较远。在商品搜索的过程中，可以计算用户输入的关键字与数据库中商品名间的相似度，在商品数据库中找出相似度最大的商品，推荐给用户。这种相近的程度就是词语的相似度。在实际的工程开发中可以通过word2vec实现词语相似度的计算。</p>
<h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><pre><code>from sklearn.datasets import fetch_20newsgroups

news = fetch_20newsgroups(subset=&apos;all&apos;)
X, y = news.data, news.target

from bs4 import BeautifulSoup
import nltk, re


# 把段落分解成由句子组成的list（每个句子又被分解成词语）
def news_to_sentences(news):
    news_text = BeautifulSoup(news, &apos;lxml&apos;).get_text()
    tokenizer = nltk.data.load(&apos;tokenizers/punkt/english.pickle&apos;)
    raw_sentences = tokenizer.tokenize(news_text)

    # 对每个句子进行处理，分解成词语
    sentences = []
    for sent in raw_sentences:
        sentences.append(re.sub(&apos;[^a-zA-Z]&apos;, &apos; &apos;, sent.lower().strip()).split())
    return sentences


sentences = []

for x in X:
    sentences += news_to_sentences(x)

# import numpy
# # 将预处理过的&quot;词库&quot;保存到文件中，便于调试
# numpy_array = numpy.array(sentences)
# numpy.save(&apos;sentences.npy&apos;, numpy_array)
#
# # 将预处理后的&quot;词库&quot;从文件中读出，便于调试
# numpy_array = numpy.load(&apos;sentences.npy&apos;)
# sentences = numpy_array.tolist()

num_features = 300
min_word_count = 20
num_workers = 2
context = 5
downsampling = 1e-3

from gensim.models import word2vec

model = word2vec.Word2Vec(sentences, workers=num_workers,         size=num_features, min_count=min_word_count, window=context,
                      sample=downsampling)

model.init_sims(replace=True)

# 保存word2vec训练参数便于调试
# model.wv.save_word2vec_format(&apos;word2vec_model.bin&apos;, binary=True)
# model.wv.load_word2vec_format(&apos;word2vec_model.bin&apos;, binary=True)

print &apos;词语相似度计算：&apos;
print &apos;morning vs morning:&apos;
print model.n_similarity(&apos;morning&apos;, &apos;morning&apos;)
print &apos;morning vs afternoon:&apos;
print model.n_similarity(&apos;morning&apos;, &apos;afternoon&apos;)
print &apos;morning vs hello:&apos;
print model.n_similarity(&apos;morning&apos;, &apos;hellow&apos;)
print &apos;morning vs shell:&apos;
print model.n_similarity(&apos;morning&apos;, &apos;shell&apos;)
</code></pre><h1 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h1><pre><code>/Users/liucaiquan/anaconda/bin/python /Users/liucaiquan/PycharmProjects/WordSimilarityCalculation/src/test.py
词语相似度计算：
morning vs morning:
1.0
morning vs afternoon:
0.871482091583
morning vs hello:
0.731609166442
morning vs shell:
0.709714434122
</code></pre><h1 id="调试技巧"><a href="#调试技巧" class="headerlink" title="调试技巧"></a>调试技巧</h1><p>在开发调试的过程中，会出现错误，需要重新运行程序。如果每次修改后，都从头开始执行，肯定会消耗很多无用的时间。比如，预处理后的文本结果和word2vec的训练参数，这些中间结果可以保持下来，当遇到问题时，就可以从文件中读取结果，而不需要每次都从头开始。</p>
<h1 id="源码下载地址"><a href="#源码下载地址" class="headerlink" title="源码下载地址"></a>源码下载地址</h1><p><a href="https://github.com/CaiquanLiu/MachineLearning" target="_blank" rel="external">https://github.com/CaiquanLiu/MachineLearning</a></p>
<h1 id="代码参考"><a href="#代码参考" class="headerlink" title="代码参考"></a>代码参考</h1><p>《Python机器学习及实践：从零开始通往Kaggle竞赛之路》</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Liu Caiquan" />
          <p class="site-author-name" itemprop="name">Liu Caiquan</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liu Caiquan</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
